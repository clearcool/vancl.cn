<?phpnamespace App\Http\Controllers\home;use Illuminate\Http\Request;use DB;use App\Http\Requests;use App\Http\Controllers\Controller;use Illuminate\Routing\Route;use Cache;class HomeController extends Controller{    /**     * 首页方法     * @param     * @return null     */    public function index()    {        return view('home.index');    }    /**     * 前台登录页面     * @return     */    public function getLogin()    {        return view('home.login');    }    /**     * 前台登录信息     * @return     */    public function postLoginb()    {        echo '33';    }    /**     * 前台注册页面     * @return     */    public function getRegister()    {        return view('home.register');    }    /**     * 前台注册信息     * @return     */    public function postRegisterb(Request $request)    {        $user = $request->all();        dd($user);    }    /**     * 详情页方法     * @param     * @return     */    public function getDetails()    {        return view('home.details');    }    /**     * 头部列表     * @param     * @return     */    public function getHead(Request $request)    {   //获取父页面传值        $name = $request->input('name');        //查询商品类的id        $shoptype=DB::table('shop_type')                    ->where('stname',$name)                    ->value('st_id');        //查询商品类        $shoptitle=DB::table('shop_type')                ->where('p_id',$shoptype)                ->get();                        //多表查询商品信息             // DB::connection()->enableQueryLog();        $st=DB::table('shop_type')             ->where('p_id',$shoptype)              ->select('st_id','stname')             ->get();        for ($i=0; $i <count($st) ; $i++) {             $shop[$st[$i]->stname]=[];            $s=DB::table('shop')->where('st_id','=',$st[$i]->st_id) ->get();             foreach($s as $k=>$v)             {              array_push($shop[$st[$i]->stname],$v);             }        }        // dd($shop);        return view('home.headlist',['shoptitle'=>$shoptitle ,'shop'=>$shop]);    }    /**     * 列表页方法     * @param     * @return     */    public function getList(Request $request)    {        //用户列表页        $id = $request->input('id');        if(!empty("a"))        {            // DB::connection()->enableQueryLog();            $shop = DB::table('shop')                ->where('st_id',$id)                ->paginate(2);            // dd(DB::getQueryLog());        }        switch($request->input('a')){            case "default":                $shop = DB::table('shop')                    ->where('st_id',$id)                    ->paginate(2);                break;            case "sole":                $shop = DB::table('shop as s')                    ->where('st_id',$id)                    ->orderBy('Sales', 'desc')                    ->paginate(2);                break;            case "praise":                // DB::connection()->enableQueryLog();                $shop = DB::table('shop')                    ->where('st_id',$id)                    ->orderby('praise','desc')                    ->paginate(2);                // dd(DB::getQueryLog());                break;            case "newtime":                $shop = DB::table('shop as s')                    ->where('st_id',$id)                    ->orderBy('uptime', 'asc')                    ->paginate(2);                break;        }        //商品库存        $shopsales = DB::table('shop')            ->where('st_id',$id)            ->value('Sales');        //类别名查询        $titletype=DB::table('shop_type')            ->where('st_id',$id)            ->value('stname');        //获取所有的请求参数        $all = $request->all();        //解析模板        return view('home.list',['id'=>$id,'shopsales'=>$shopsales,'titletype'=>$titletype,'shop'=>$shop ,'all'=>$all]);    }   }